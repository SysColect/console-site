import{c as X,j as e,r as n,D as q,a as G,b as z,T as y,G as B,L as J,d as N,e as K,g as $,A as H,B as b,I as D,F as Q,f as Y,S as Z,M as L,h as _,i as W,k as M,l as U,s as ee,u as se,m as te,n as ne,o as re,p as O,q as ae,t as oe,C as le,P as ie,v as ce,w as de}from"./index-CyW68QXl.js";import{T as he,a as ue,b as xe,c as R,d as m,e as me,M as je}from"./MoreVert-L0x4JGm1.js";const fe=X(e.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),ge=({open:l,onClose:i})=>{const[r,h]=n.useState(""),[c,j]=n.useState({});n.useEffect(()=>{l&&fetch("/src/assets/icons.sanitized.json").then(t=>t.json()).then(t=>j(t))},[l]);const u=n.useMemo(()=>Object.keys(c).filter(t=>{const o=r.toLowerCase(),f=c[t].search;return t.toLowerCase().includes(o)||f.some(g=>g.toLowerCase().includes(o))}),[c,r]);return e.jsxs(q,{open:l,onClose:()=>i(null),fullWidth:!0,maxWidth:"md",children:[e.jsx(G,{children:"Select an Icon"}),e.jsxs(z,{children:[e.jsx(y,{autoFocus:!0,margin:"dense",id:"search",label:"Search Icons",type:"text",fullWidth:!0,variant:"standard",value:r,onChange:t=>h(t.target.value)}),e.jsx(B,{container:!0,spacing:2,sx:{mt:2},children:u.map(t=>e.jsx(B,{item:!0,xs:3,children:e.jsxs(J,{onClick:()=>i(t),children:[e.jsx(N,{children:e.jsx("i",{className:`fa-solid fa-${t}`})}),e.jsx(K,{primary:t})]})},t))})]})]})},pe=({open:l,onClose:i,tool:r})=>{const[h,c]=n.useState(""),[j,u]=n.useState(""),[t,o]=n.useState("redirect"),[f,g]=n.useState(""),[p,x]=n.useState(""),[F,I]=n.useState(!1),[k,C]=n.useState(null),w=$();n.useEffect(()=>{r?(c(r.name||""),u(r.description||""),o(r.action||"redirect"),g(r.actionProperties?.redirectTo||""),x(r.icon||"")):(c(""),u(""),o("redirect"),g(""),x(""))},[r]);const T=async()=>{if(C(null),!h){C("Name is required.");return}const a={name:h,description:j,action:t,actionProperties:{redirectTo:f},icon:p};try{const S={...r,...a},E=r?M(w,"consoleTool",r.id):M(U(w,"consoleTool"));await ee(E,a,{merge:!0}),i({...S,id:E.id})}catch(S){console.error("Error saving tool:",S),C("Failed to save tool.")}},A=a=>{a&&x(a),I(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(q,{open:l,onClose:()=>i(),fullWidth:!0,maxWidth:"sm",children:[e.jsx(G,{children:r?"Edit Tool":"Add Tool"}),e.jsxs(z,{children:[k&&e.jsx(H,{severity:"error",sx:{mb:2},children:k}),e.jsx(y,{autoFocus:!0,margin:"dense",id:"name",label:"Name",type:"text",fullWidth:!0,variant:"standard",value:h,onChange:a=>c(a.target.value)}),e.jsx(y,{margin:"dense",id:"description",label:"Description",type:"text",fullWidth:!0,multiline:!0,rows:3,variant:"standard",value:j,onChange:a=>u(a.target.value)}),e.jsxs(b,{sx:{display:"flex",alignItems:"flex-end"},children:[e.jsx(y,{margin:"dense",id:"icon",label:"Icon",type:"text",fullWidth:!0,variant:"standard",value:p,onChange:a=>x(a.target.value),helperText:"Use the name of a Font Awesome icon (e.g., 'home', 'gear')."}),e.jsx(D,{onClick:()=>I(!0),children:e.jsx(fe,{})})]}),e.jsxs(Q,{fullWidth:!0,margin:"dense",children:[e.jsx(Y,{id:"action-label",children:"Action"}),e.jsx(Z,{labelId:"action-label",id:"action",value:t,label:"Action",onChange:a=>o(a.target.value),children:e.jsx(L,{value:"redirect",children:"redirect"})})]}),t==="redirect"&&e.jsx(y,{margin:"dense",id:"redirectTo",label:"Redirect Path",type:"text",fullWidth:!0,variant:"standard",value:f,onChange:a=>g(a.target.value),helperText:"E.g., /tools/my-custom-tool"})]}),e.jsxs(_,{children:[e.jsx(W,{onClick:()=>i(),children:"Cancel"}),e.jsx(W,{onClick:T,children:"Save"})]})]}),e.jsx(ge,{open:F,onClose:A})]})},Te=()=>{const[l,i]=n.useState([]),[r,h]=n.useState(!0),[c,j]=n.useState(null),[u,t]=n.useState(null),[o,f]=n.useState(null),[g,p]=n.useState(!1),x=$(),F=se(),{showConfirmation:I,showAlert:k}=te(),C=n.useCallback(async()=>{h(!0),j(null);try{const s=U(x,"consoleTool"),v=(await ne(s)).docs.map(P=>({id:P.id,...P.data()}));i(v)}catch(s){console.error("Error fetching tools:",s),j("Failed to load tools. Please try again later.")}finally{h(!1)}},[x]);n.useEffect(()=>{C()},[C]);const w=(s,d)=>{t(s.currentTarget),f(d)},T=()=>{t(null)},A=()=>{f(null),p(!0)},a=()=>{p(!0),T()},S=()=>{T(),o&&I({title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir a ferramenta ${o.name}? Esta ação não pode ser desfeita.`,onConfirm:async()=>{try{if(!o)return;const s=M(x,"consoleTool",o.id);await de(s),i(l.filter(d=>d.id!==o.id))}catch(s){console.error("Error deleting tool:",s),k({title:"Erro",message:"Falha ao excluir a ferramenta. Tente novamente mais tarde."})}}})},E=s=>{if(p(!1),s){const d=l.findIndex(v=>v.id===s.id);if(d!==-1){const v=[...l];v[d]=s,i(v)}else i([s,...l])}},V=s=>s?e.jsx("i",{className:`fa-solid fa-${s}`}):null;return e.jsxs(b,{sx:{display:"flex"},children:[e.jsx(re,{position:"fixed",children:e.jsxs(O,{children:[e.jsx(D,{edge:"start",color:"inherit","aria-label":"back",onClick:()=>F(-1),sx:{mr:2},children:e.jsx(ae,{})}),e.jsx(oe,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Gerenciador de Ferramentas"}),e.jsx(W,{variant:"contained",color:"secondary",onClick:A,children:"Incluir Ferramenta"})]})}),e.jsxs(b,{component:"main",sx:{flexGrow:1,p:3},children:[e.jsx(O,{})," ",r?e.jsx(b,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(le,{})}):c?e.jsx(H,{severity:"error",children:c}):e.jsxs(b,{sx:{width:"100%",overflowX:"auto"},children:[e.jsx(he,{component:ie,children:e.jsxs(ue,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(xe,{children:e.jsxs(R,{children:[e.jsx(m,{children:"Icon"}),e.jsx(m,{children:"Nome"}),e.jsx(m,{children:"Descrição"}),e.jsx(m,{children:"Ações"})]})}),e.jsx(me,{children:l.map(s=>e.jsxs(R,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(m,{children:e.jsx(N,{children:V(s.icon)})}),e.jsx(m,{component:"th",scope:"row",children:s.name}),e.jsx(m,{children:s.description||"N/A"}),e.jsx(m,{children:e.jsx(D,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:d=>w(d,s),children:e.jsx(je,{})})})]},s.id))})]})}),e.jsxs(ce,{id:"long-menu",anchorEl:u,open:!!u,onClose:T,children:[e.jsx(L,{onClick:a,children:"Editar"}),e.jsx(L,{onClick:S,children:"Excluir"})]}),e.jsx(pe,{open:g,onClose:E,tool:o})]})]})]})};export{Te as default};
