import{c as J,j as e,r as s,D as N,a as z,b as X,T as v,G as B,L as K,d as $,e as Q,g as H,A as U,B as L,I as W,f as Y,F as Z,h as _,S as ee,M,i as te,k as O,X as se,l as D,m as oe,n as V,s as re,o as ne,p as ae,C as le,P as ie,q as ce,t as de}from"./index-DYHoXdso.js";import{M as ue}from"./MoreVert-CgrGSDwl.js";import{S as he}from"./Search-DRs91dH_.js";import{T as xe}from"./ToolPageLayout-B0UWFUD6.js";import{T as me,a as pe,b as fe,c as q,d as p,e as je}from"./TableRow-BXVGgdlF.js";const ge=J(e.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),Te=({open:l,onClose:i})=>{const[r,u]=s.useState(""),[d,f]=s.useState({});s.useEffect(()=>{l&&fetch("/icons.sanitized.json").then(n=>n.json()).then(n=>f(n))},[l]);const h=s.useMemo(()=>Object.keys(d).filter(n=>{const a=r.toLowerCase(),j=d[n].search;return n.toLowerCase().includes(a)||j.some(g=>g.toLowerCase().includes(a))}),[d,r]);return e.jsxs(N,{open:l,onClose:()=>i(null),fullWidth:!0,maxWidth:"md",children:[e.jsx(z,{children:"Select an Icon"}),e.jsxs(X,{children:[e.jsx(v,{autoFocus:!0,margin:"dense",id:"search",label:"Search Icons",type:"text",fullWidth:!0,variant:"standard",value:r,onChange:n=>u(n.target.value)}),e.jsx(B,{container:!0,spacing:2,sx:{mt:2},children:h.map(n=>e.jsx(B,{item:!0,xs:3,children:e.jsxs(K,{onClick:()=>i(n),children:[e.jsx($,{children:e.jsx("i",{className:`fa-solid fa-${n}`})}),e.jsx(Q,{primary:n})]})},n))})]})]})},Ce=({open:l,onClose:i,tool:r})=>{const[u,d]=s.useState(""),[f,h]=s.useState(""),[n,a]=s.useState("redirect"),[j,g]=s.useState(""),[C,x]=s.useState(""),[A,E]=s.useState(!1),[F,y]=s.useState(void 0),[I,S]=s.useState(""),[P,b]=s.useState(!1),[k,G]=s.useState(null),t=H();s.useEffect(()=>{const o=async T=>{const w=D(t,"consoleToolGroups",T),R=await oe(w);R.exists()&&S(R.data().name)};r?(d(r.name||""),h(r.description||""),a(r.action||"redirect"),g(r.actionProperties?.redirectTo||""),x(r.icon||""),y(r.toolGroup),r.toolGroup?o(r.toolGroup):S("")):(d(""),h(""),a("redirect"),g(""),x(""),y(void 0),S(""))},[r,t]);const c=async()=>{if(G(null),!u){G("Name is required.");return}const o={name:u,description:f,action:n,actionProperties:{redirectTo:j},icon:C,toolGroup:F};try{const T={...r,...o},w=r?D(t,"consoleTool",r.id):D(V(t,"consoleTool"));await re(w,o,{merge:!0}),i({...T,id:w.id})}catch(T){console.error("Error saving tool:",T),G("Failed to save tool.")}},m=o=>{o&&x(o),E(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(N,{open:l,onClose:()=>i(),fullWidth:!0,maxWidth:"sm",children:[e.jsx(z,{children:r?"Edit Tool":"Add Tool"}),e.jsxs(X,{children:[k&&e.jsx(U,{severity:"error",sx:{mb:2},children:k}),e.jsx(v,{autoFocus:!0,margin:"dense",id:"name",label:"Name",type:"text",fullWidth:!0,variant:"standard",value:u,onChange:o=>d(o.target.value)}),e.jsx(v,{margin:"dense",id:"description",label:"Description",type:"text",fullWidth:!0,multiline:!0,rows:3,variant:"standard",value:f,onChange:o=>h(o.target.value)}),e.jsxs(L,{sx:{display:"flex",alignItems:"flex-end"},children:[e.jsx(v,{margin:"dense",id:"icon",label:"Icon",type:"text",fullWidth:!0,variant:"standard",value:C,onChange:o=>x(o.target.value),helperText:"Use the name of a Font Awesome icon (e.g., 'home', 'gear')."}),e.jsx(W,{onClick:()=>E(!0),children:e.jsx(ge,{})})]}),e.jsx(v,{margin:"dense",id:"toolGroup",label:"Tool Group",type:"text",fullWidth:!0,disabled:!0,value:I,InputProps:{endAdornment:e.jsx(Y,{position:"end",children:e.jsx(W,{onClick:()=>b(!0),children:e.jsx(he,{})})})}}),e.jsxs(Z,{fullWidth:!0,margin:"dense",children:[e.jsx(_,{id:"action-label",children:"Action"}),e.jsx(ee,{labelId:"action-label",id:"action",value:n,label:"Action",onChange:o=>a(o.target.value),children:e.jsx(M,{value:"redirect",children:"redirect"})})]}),n==="redirect"&&e.jsx(v,{margin:"dense",id:"redirectTo",label:"Redirect Path",type:"text",fullWidth:!0,variant:"standard",value:j,onChange:o=>g(o.target.value),helperText:"E.g., /tools/my-custom-tool"})]}),e.jsxs(te,{children:[e.jsx(O,{onClick:()=>i(),children:"Cancel"}),e.jsx(O,{onClick:c,children:"Save"})]})]}),e.jsx(Te,{open:A,onClose:m}),e.jsx(se,{open:P,onClose:()=>b(!1),onSelect:(o,T)=>{y(o),S(T.name),b(!1)},collectionName:"consoleToolGroups",headerText:"Select Tool Group",searchField:"name",displayFields:{primary:"name",secondary:"description"},db:t})]})},Ge=()=>{const[l,i]=s.useState([]),[r,u]=s.useState(!0),[d,f]=s.useState(null),[h,n]=s.useState(null),[a,j]=s.useState(null),[g,C]=s.useState(!1),x=H(),{showConfirmation:A,showAlert:E}=ne(),F=s.useCallback(async()=>{u(!0),f(null);try{const t=V(x,"consoleTool"),m=(await ae(t)).docs.map(o=>({id:o.id,...o.data()}));i(m)}catch(t){console.error("Error fetching tools:",t),f("Failed to load tools. Please try again later.")}finally{u(!1)}},[x]);s.useEffect(()=>{F()},[F]);const y=(t,c)=>{n(t.currentTarget),j(c)},I=()=>{n(null)},S=()=>{j(null),C(!0)},P=()=>{C(!0),I()},b=()=>{I(),a&&A({title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir a ferramenta ${a.name}? Esta ação não pode ser desfeita.`,onConfirm:async()=>{try{if(!a)return;const t=D(x,"consoleTool",a.id);await de(t),i(l.filter(c=>c.id!==a.id))}catch(t){console.error("Error deleting tool:",t),E({title:"Erro",message:"Falha ao excluir a ferramenta. Tente novamente mais tarde."})}}})},k=t=>{if(C(!1),t){const c=l.findIndex(m=>m.id===t.id);if(c!==-1){const m=[...l];m[c]=t,i(m)}else i([t,...l])}},G=t=>t?e.jsx("i",{className:`fa-solid fa-${t}`}):null;return e.jsx(xe,{title:"Gerenciador de Ferramentas",actions:e.jsx(O,{variant:"contained",color:"secondary",onClick:S,children:"Incluir Ferramenta"}),children:r?e.jsx(L,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(le,{})}):d?e.jsx(U,{severity:"error",children:d}):e.jsxs(L,{sx:{width:"100%",overflowX:"auto"},children:[e.jsx(me,{component:ie,children:e.jsxs(pe,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(fe,{children:e.jsxs(q,{children:[e.jsx(p,{children:"Icon"}),e.jsx(p,{children:"Nome"}),e.jsx(p,{children:"Descrição"}),e.jsx(p,{children:"Ações"})]})}),e.jsx(je,{children:l.map(t=>e.jsxs(q,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(p,{children:e.jsx($,{children:G(t.icon)})}),e.jsx(p,{component:"th",scope:"row",children:t.name}),e.jsx(p,{children:t.description||"N/A"}),e.jsx(p,{children:e.jsx(W,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:c=>y(c,t),children:e.jsx(ue,{})})})]},t.id))})]})}),e.jsxs(ce,{id:"long-menu",anchorEl:h,open:!!h,onClose:I,children:[e.jsx(M,{onClick:P,children:"Editar"}),e.jsx(M,{onClick:b,children:"Excluir"})]}),e.jsx(Ce,{open:g,onClose:k,tool:a})]})})};export{Ge as default};
