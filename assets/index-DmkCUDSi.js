import{r as a,g as R,j as e,D as A,a as I,b as W,w as D,T as N,C,A as L,h as O,i as m,B as V,P as z,l as E,W as v,X as B,Y as H,m as w}from"./index-DTgOTrzU.js";import{T as K}from"./ToolPageLayout-C9Py0OxF.js";import{T as M,a as X,b as Y,c as U,d as r,e as G}from"./TableRow-BC8ndXSd.js";const _=()=>{const[j,d]=a.useState([]),[l,n]=a.useState(!1),[f,t]=a.useState(null),[u,h]=a.useState(!0),[x,q]=a.useState(""),[k,F]=a.useState(""),[i,P]=a.useState(null),g=R(),p=async()=>{n(!0),t(null);try{const s=E(g,"user"),o=v(s,B("email","==",x)),c=await w(o);if(c.empty)t("User not found."),d([]);else{const b=c.docs[0];P(b.id),F(x),h(!1)}}catch(s){console.error("Error searching user:",s),t("Failed to search for user.")}finally{n(!1)}};a.useEffect(()=>{(async()=>{if(i){n(!0),t(null),d([]);try{const o=E(g,"consoleLogs"),c=v(o,B("userId","==",i),H("timestamp","desc")),S=(await w(c)).docs.map(T=>({id:T.id,...T.data()}));d(S),S.length===0&&t("No logs found for this user.")}catch(o){console.error("Error fetching logs:",o),t("Failed to fetch logs.")}finally{n(!1)}}})()},[i,g]);const y=()=>{h(!1),t(null)};return e.jsxs(K,{title:"Visualizador de Logs",children:[e.jsxs(A,{open:u,onClose:y,children:[e.jsx(I,{children:"Selecionar Usuário"}),e.jsxs(W,{children:[e.jsx(D,{variant:"body2",sx:{mb:2},children:"Digite o e-mail do usuário para buscar os logs."}),e.jsx(N,{autoFocus:!0,margin:"dense",id:"email",label:"Email do Usuário",type:"email",fullWidth:!0,variant:"standard",value:x,onChange:s=>q(s.target.value),onKeyPress:s=>s.key==="Enter"&&p()}),l&&e.jsx(C,{sx:{display:"block",margin:"10px auto"}}),f&&e.jsx(L,{severity:"warning",sx:{mt:2},children:f})]}),e.jsxs(O,{children:[e.jsx(m,{onClick:y,children:"Cancelar"}),e.jsx(m,{onClick:p,disabled:l,children:"Buscar"})]})]}),!u&&e.jsx(m,{onClick:()=>h(!0),children:"Buscar outro usuário"}),l&&!u&&e.jsx(C,{}),j.length>0?e.jsxs(V,{children:[e.jsxs(D,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:["Logs para: ",k]}),e.jsx(M,{component:z,children:e.jsxs(X,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(Y,{children:e.jsxs(U,{children:[e.jsx(r,{children:"Timestamp"}),e.jsx(r,{children:"Level"}),e.jsx(r,{children:"Message"}),e.jsx(r,{children:"URL"})]})}),e.jsx(G,{children:j.map(s=>e.jsxs(U,{children:[e.jsx(r,{children:s.timestamp?.toDate().toLocaleString()}),e.jsx(r,{children:s.level}),e.jsx(r,{children:s.message}),e.jsx(r,{children:s.url})]},s.id))})]})})]}):!l&&i&&e.jsx(L,{severity:"info",children:"Nenhum log encontrado para este usuário."})]})};export{_ as default};
