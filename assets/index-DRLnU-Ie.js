import{r as a,g as T,j as e,e as b,C as B,A as p,B as v,v as C,P as D,i as U,U as w,V as E,W as q,k as F}from"./index-BowguTbL.js";import{T as P}from"./ToolPageLayout-CYGWEmfP.js";import{D as R}from"./DynamicSelectorDialog-DpoPdyz_.js";import{T as V,a as k,b as A,c as g,d as r,e as N}from"./TableRow-DeDaSUMP.js";const M=()=>{const[n,i]=a.useState([]),[c,d]=a.useState(!1),[h,u]=a.useState(null),[j,l]=a.useState(!0),[t,f]=a.useState(null),m=T();a.useEffect(()=>{(async()=>{if(t){d(!0),u(null),i([]);try{const o=U(m,"consoleLogs"),S=w(o,E("userId","==",t.id),q("timestamp","desc")),L=(await F(S)).docs.map(x=>({id:x.id,...x.data()}));i(L)}catch(o){console.error("Error fetching logs:",o),u("Failed to fetch logs.")}finally{d(!1)}}})()},[t,m]);const y=(s,o)=>{f({...o,id:s}),l(!1)};return e.jsxs(P,{title:"Visualizador de Logs",children:[e.jsx(R,{open:j,onClose:()=>l(!1),onSelect:y,collectionName:"user",headerText:"Selecionar Usuário",searchField:"email",displayFields:{primary:"name",secondary:"email"}}),t&&e.jsx(b,{onClick:()=>l(!0),children:"Buscar outro usuário"}),c&&e.jsx(B,{}),h&&e.jsx(p,{severity:"warning",sx:{mt:2},children:h}),n.length>0?e.jsxs(v,{children:[e.jsxs(C,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:["Logs para: ",t?.email," (",t?.name,")"]}),e.jsx(V,{component:D,children:e.jsxs(k,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(A,{children:e.jsxs(g,{children:[e.jsx(r,{children:"Timestamp"}),e.jsx(r,{children:"Level"}),e.jsx(r,{children:"Message"}),e.jsx(r,{children:"URL"})]})}),e.jsx(N,{children:n.map(s=>e.jsxs(g,{children:[e.jsx(r,{children:s.timestamp?.toDate().toLocaleString()}),e.jsx(r,{children:s.level}),e.jsx(r,{children:s.message}),e.jsx(r,{children:s.url})]},s.id))})]})})]}):!c&&t&&e.jsx(p,{severity:"info",children:"Nenhum log encontrado para este usuário."})]})};export{M as default};
