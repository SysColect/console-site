import{j as o,u as x,$ as S,a as N,m as R,q as h,r as s,i as L,F as w,R as G,N as y,k as D,L as M}from"./index-CMTZ79cl.js";import{T as q}from"./ToolPageLayout-b2zAKi_p.js";const A=()=>o.jsx(x,{name:"actionProperties.redirectTo",label:"Caminho do Redirecionamento",placeholder:"/tool/some-path",formField:!0}),V=t=>o.jsxs(o.Fragment,{children:[o.jsx(x,{name:"name",label:"Nome",formField:!0}),o.jsx(x,{name:"description",label:"Descrição",multiline:!0,rows:3,formField:!0}),o.jsx(S,{name:"icon",label:"Ícone",formField:!0}),o.jsx(N,{name:"toolGroup",label:"Grupo de Ferramentas",optionsMap:t,formField:!0}),o.jsx(R,{name:"action",label:"Ação",options:[{value:"redirect",label:"Redirecionar"}],formField:!0}),o.jsx(A,{})]}),$=t=>{const a={};if(a.name=h.required("O nome da ferramenta é obrigatório")(t.name),a.icon=h.required("Você deve selecionar um ícone")(t.icon),t.action==="redirect"){const l=t.actionProperties?.redirectTo;a["actionProperties.redirectTo"]=h.required("O caminho para o redirecionamento é obrigatório")(l)}return Object.entries(a).reduce((l,[f,u])=>(u&&(l[f]=u),l),{})},k=()=>{const[t,a]=s.useState([]),[l,f]=s.useState({}),[u,T]=s.useState(!0),[b,g]=s.useState(null),{showConfirmation:v,showAlert:j}=L(),c=s.useMemo(()=>{const e=new w("consoleTool"),r=new y;return new G(e,r)},[]),F=s.useMemo(()=>{const e=new w("consoleToolGroups"),r=new y;return new G(e,r)},[]),p=s.useCallback(async()=>{T(!0),g(null);try{const[e,r]=await Promise.all([c.getAll({sort:{field:"name",direction:"asc"}}),F.getAll({sort:{field:"name",direction:"asc"}})]);a(e);const d=r.reduce((n,i)=>(n[i.id]=i.name,n),{});f(d)}catch(e){console.error("Error fetching data:",e),g("Falha ao carregar os dados. Por favor, tente novamente mais tarde.")}finally{T(!1)}},[c,F]);s.useEffect(()=>{p()},[p]);const E=[{field:"icon",headerName:"Ícone",width:80,renderCell:e=>o.jsx(M,{children:o.jsx("i",{className:`fa-solid fa-${e.value}`,style:{fontSize:20}})})},{field:"name",headerName:"Nome",width:250},{field:"description",headerName:"Descrição",flex:1},{field:"toolGroup",headerName:"Grupo",width:200,valueGetter:e=>l[e]||"-"}],C=async(e,r)=>{const{id:d,...n}=e;(n.toolGroup===""||n.toolGroup===void 0)&&(n.toolGroup=null);try{if(r){const i=await c.create(n);a(m=>[...m,i])}else await c.update(d,n),a(i=>i.map(m=>m.id===d?{...m,...n,id:d}:m))}catch(i){console.error("Error saving tool:",i),j({title:"Erro",message:"Falha ao salvar a ferramenta."})}},P=e=>{v({title:"Confirmar Exclusão",message:`Você tem certeza que deseja excluir a ferramenta ${e.name}? Esta ação não pode ser desfeita.`,onConfirm:async()=>{try{await c.delete(e.id),a(t.filter(r=>r.id!==e.id))}catch(r){console.error("Error deleting tool:",r),j({title:"Erro",message:"Falha ao excluir a ferramenta."})}}})};return o.jsx(D,{title:"Ferramentas",rows:t,columns:E,loading:u,error:b,initialValues:{name:"",description:"",icon:"",toolGroup:null,action:"redirect",actionProperties:{redirectTo:""}},dialogTitle:"Ferramenta",onSave:C,onDelete:P,onRefresh:p,onValidate:$,hideAddButton:!1,children:V(l)})},I=()=>o.jsx(q,{title:"Gerenciador de Ferramentas",children:o.jsx(k,{})});export{I as default};
