import{c as U,j as e,r as n,D as O,a as R,b as q,T as I,G as M,L as V,d as z,e as X,g as G,A as $,B as D,I as H,F as J,f as K,S as Q,M as A,h as Y,i as L,k as P,l as N,s as Z,u as _,m as ee,C as se,P as te,n as ne,o as re}from"./index-CYRXvscp.js";import{M as ae}from"./MoreVert-DGKlEHmU.js";import{T as oe}from"./ToolPageLayout-oshJhCXu.js";import{T as le,a as ie,b as ce,c as B,d as m,e as de}from"./TableRow-CHWf36jP.js";const ue=U(e.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),he=({open:l,onClose:i})=>{const[r,u]=n.useState(""),[c,j]=n.useState({});n.useEffect(()=>{l&&fetch("/icons.sanitized.json").then(t=>t.json()).then(t=>j(t))},[l]);const h=n.useMemo(()=>Object.keys(c).filter(t=>{const o=r.toLowerCase(),f=c[t].search;return t.toLowerCase().includes(o)||f.some(g=>g.toLowerCase().includes(o))}),[c,r]);return e.jsxs(O,{open:l,onClose:()=>i(null),fullWidth:!0,maxWidth:"md",children:[e.jsx(R,{children:"Select an Icon"}),e.jsxs(q,{children:[e.jsx(I,{autoFocus:!0,margin:"dense",id:"search",label:"Search Icons",type:"text",fullWidth:!0,variant:"standard",value:r,onChange:t=>u(t.target.value)}),e.jsx(M,{container:!0,spacing:2,sx:{mt:2},children:h.map(t=>e.jsx(M,{item:!0,xs:3,children:e.jsxs(V,{onClick:()=>i(t),children:[e.jsx(z,{children:e.jsx("i",{className:`fa-solid fa-${t}`})}),e.jsx(X,{primary:t})]})},t))})]})]})},xe=({open:l,onClose:i,tool:r})=>{const[u,c]=n.useState(""),[j,h]=n.useState(""),[t,o]=n.useState("redirect"),[f,g]=n.useState(""),[p,x]=n.useState(""),[k,b]=n.useState(!1),[v,S]=n.useState(null),C=G();n.useEffect(()=>{r?(c(r.name||""),h(r.description||""),o(r.action||"redirect"),g(r.actionProperties?.redirectTo||""),x(r.icon||"")):(c(""),h(""),o("redirect"),g(""),x(""))},[r]);const F=async()=>{if(S(null),!u){S("Name is required.");return}const a={name:u,description:j,action:t,actionProperties:{redirectTo:f},icon:p};try{const y={...r,...a},E=r?P(C,"consoleTool",r.id):P(N(C,"consoleTool"));await Z(E,a,{merge:!0}),i({...y,id:E.id})}catch(y){console.error("Error saving tool:",y),S("Failed to save tool.")}},w=a=>{a&&x(a),b(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(O,{open:l,onClose:()=>i(),fullWidth:!0,maxWidth:"sm",children:[e.jsx(R,{children:r?"Edit Tool":"Add Tool"}),e.jsxs(q,{children:[v&&e.jsx($,{severity:"error",sx:{mb:2},children:v}),e.jsx(I,{autoFocus:!0,margin:"dense",id:"name",label:"Name",type:"text",fullWidth:!0,variant:"standard",value:u,onChange:a=>c(a.target.value)}),e.jsx(I,{margin:"dense",id:"description",label:"Description",type:"text",fullWidth:!0,multiline:!0,rows:3,variant:"standard",value:j,onChange:a=>h(a.target.value)}),e.jsxs(D,{sx:{display:"flex",alignItems:"flex-end"},children:[e.jsx(I,{margin:"dense",id:"icon",label:"Icon",type:"text",fullWidth:!0,variant:"standard",value:p,onChange:a=>x(a.target.value),helperText:"Use the name of a Font Awesome icon (e.g., 'home', 'gear')."}),e.jsx(H,{onClick:()=>b(!0),children:e.jsx(ue,{})})]}),e.jsxs(J,{fullWidth:!0,margin:"dense",children:[e.jsx(K,{id:"action-label",children:"Action"}),e.jsx(Q,{labelId:"action-label",id:"action",value:t,label:"Action",onChange:a=>o(a.target.value),children:e.jsx(A,{value:"redirect",children:"redirect"})})]}),t==="redirect"&&e.jsx(I,{margin:"dense",id:"redirectTo",label:"Redirect Path",type:"text",fullWidth:!0,variant:"standard",value:f,onChange:a=>g(a.target.value),helperText:"E.g., /tools/my-custom-tool"})]}),e.jsxs(Y,{children:[e.jsx(L,{onClick:()=>i(),children:"Cancel"}),e.jsx(L,{onClick:F,children:"Save"})]})]}),e.jsx(he,{open:k,onClose:w})]})},pe=()=>{const[l,i]=n.useState([]),[r,u]=n.useState(!0),[c,j]=n.useState(null),[h,t]=n.useState(null),[o,f]=n.useState(null),[g,p]=n.useState(!1),x=G(),{showConfirmation:k,showAlert:b}=_(),v=n.useCallback(async()=>{u(!0),j(null);try{const s=N(x,"consoleTool"),T=(await ee(s)).docs.map(W=>({id:W.id,...W.data()}));i(T)}catch(s){console.error("Error fetching tools:",s),j("Failed to load tools. Please try again later.")}finally{u(!1)}},[x]);n.useEffect(()=>{v()},[v]);const S=(s,d)=>{t(s.currentTarget),f(d)},C=()=>{t(null)},F=()=>{f(null),p(!0)},w=()=>{p(!0),C()},a=()=>{C(),o&&k({title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir a ferramenta ${o.name}? Esta ação não pode ser desfeita.`,onConfirm:async()=>{try{if(!o)return;const s=P(x,"consoleTool",o.id);await re(s),i(l.filter(d=>d.id!==o.id))}catch(s){console.error("Error deleting tool:",s),b({title:"Erro",message:"Falha ao excluir a ferramenta. Tente novamente mais tarde."})}}})},y=s=>{if(p(!1),s){const d=l.findIndex(T=>T.id===s.id);if(d!==-1){const T=[...l];T[d]=s,i(T)}else i([s,...l])}},E=s=>s?e.jsx("i",{className:`fa-solid fa-${s}`}):null;return e.jsx(oe,{title:"Gerenciador de Ferramentas",actions:e.jsx(L,{variant:"contained",color:"secondary",onClick:F,children:"Incluir Ferramenta"}),children:r?e.jsx(D,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(se,{})}):c?e.jsx($,{severity:"error",children:c}):e.jsxs(D,{sx:{width:"100%",overflowX:"auto"},children:[e.jsx(le,{component:te,children:e.jsxs(ie,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(ce,{children:e.jsxs(B,{children:[e.jsx(m,{children:"Icon"}),e.jsx(m,{children:"Nome"}),e.jsx(m,{children:"Descrição"}),e.jsx(m,{children:"Ações"})]})}),e.jsx(de,{children:l.map(s=>e.jsxs(B,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(m,{children:e.jsx(z,{children:E(s.icon)})}),e.jsx(m,{component:"th",scope:"row",children:s.name}),e.jsx(m,{children:s.description||"N/A"}),e.jsx(m,{children:e.jsx(H,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:d=>S(d,s),children:e.jsx(ae,{})})})]},s.id))})]})}),e.jsxs(ne,{id:"long-menu",anchorEl:h,open:!!h,onClose:C,children:[e.jsx(A,{onClick:w,children:"Editar"}),e.jsx(A,{onClick:a,children:"Excluir"})]}),e.jsx(xe,{open:g,onClose:y,tool:o})]})})};export{pe as default};
