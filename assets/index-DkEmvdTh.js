import{r as n,g as P,j as e,D as W,a as L,b as q,A as F,T as b,B as E,I as M,d as _,e as I,f as R,s as $,i as B,Y as z,u as H,k as U,C as V,P as X,l as Y,M as w,m as J}from"./index-BowguTbL.js";import{M as K}from"./MoreVert-B2qTNqdA.js";import{A as Q,I as Z}from"./IconPickerDialog-BawGLMRa.js";import{T as ee}from"./ToolPageLayout-CYGWEmfP.js";import{T as oe,a as se,b as ne,c as G,d as l,e as te}from"./TableRow-DeDaSUMP.js";const re=({open:u,onClose:a,toolGroup:t})=>{const[h,x]=n.useState(""),[f,m]=n.useState(""),[p,r]=n.useState(""),[T,C]=n.useState(!1),[j,i]=n.useState(null),y=P();n.useEffect(()=>{t?(x(t.name||""),m(t.description||""),r(t.icon||"")):(x(""),m(""),r(""))},[t]);const S=async()=>{if(i(null),!h){i("Please fill in the name field.");return}try{if(t){const s=R(y,"consoleToolGroups",t.id),c={name:h,description:f,icon:p};await $(s,c,{merge:!0}),a({...t,...c})}else{const s=B(y,"consoleToolGroups"),c={name:h,description:f,icon:p},A=await z(s,c);a({id:A.id,...c})}}catch(s){s instanceof Error?i(s.message):i("An unexpected error occurred."),console.error("Error saving tool group:",s)}},D=s=>{s&&r(s),C(!1)},v=(s,c)=>{a()};return e.jsxs(W,{open:u,onClose:v,children:[e.jsx(L,{children:t?"Edit Tool Group":"Add Tool Group"}),e.jsxs(q,{children:[j&&e.jsx(F,{severity:"error",sx:{mb:2},children:j}),t&&e.jsx(b,{autoFocus:!0,margin:"dense",id:"id",label:"Tool Group ID",type:"text",fullWidth:!0,disabled:!0,value:t?.id||""}),e.jsx(b,{margin:"dense",id:"name",label:"Name",type:"text",fullWidth:!0,value:h,onChange:s=>x(s.target.value)}),e.jsx(b,{margin:"dense",id:"description",label:"Description",type:"text",fullWidth:!0,value:f,onChange:s=>m(s.target.value)}),e.jsxs(E,{sx:{display:"flex",alignItems:"flex-end"},children:[e.jsx(b,{margin:"dense",id:"icon",label:"Icon",type:"text",fullWidth:!0,variant:"standard",value:p,onChange:s=>r(s.target.value),helperText:"Use the name of a Font Awesome icon (e.g., 'home', 'gear')."}),e.jsx(M,{onClick:()=>C(!0),children:e.jsx(Q,{})})]})]}),e.jsxs(_,{children:[e.jsx(I,{onClick:()=>a(),children:"Cancel"}),e.jsx(I,{onClick:S,children:"Save"})]}),e.jsx(Z,{open:T,onClose:D})]})},ue=()=>{const[u,a]=n.useState([]),[t,h]=n.useState(!0),[x,f]=n.useState(null),[m,p]=n.useState(null),[r,T]=n.useState(null),[C,j]=n.useState(!1),i=P(),{showConfirmation:y,showAlert:S}=H(),D=n.useCallback(async()=>{h(!0),f(null);try{const o=B(i,"consoleToolGroups"),g=(await U(o)).docs.map(k=>({id:k.id,...k.data()}));a(g)}catch(o){console.error("Error fetching tool groups:",o),f("Failed to load tool groups. Please try again later.")}finally{h(!1)}},[i]);n.useEffect(()=>{D()},[D]);const v=(o,d)=>{p(o.currentTarget),T(d)},s=()=>{p(null)},c=()=>{j(!0),s()},A=()=>{s(),r&&y({title:"Confirm Deletion",message:`Are you sure you want to delete the tool group ${r.name}? This action cannot be undone.`,onConfirm:async()=>{try{if(!r)return;const o=R(i,"consoleToolGroups",r.id);await J(o),a(u.filter(d=>d.id!==r.id))}catch(o){console.error("Error deleting tool group:",o),S({title:"Error",message:"Failed to delete tool group. Please try again later."})}}})},O=()=>{T(null),j(!0)},N=o=>o?e.jsx("i",{className:`fa-solid fa-${o}`,style:{fontSize:24}}):null;return e.jsx(ee,{title:"Tool Group Manager",actions:e.jsx(I,{variant:"contained",color:"secondary",onClick:O,children:"Add Tool Group"}),children:t?e.jsx(E,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(V,{})}):x?e.jsx(F,{severity:"error",children:x}):e.jsxs(E,{sx:{width:"100%",overflowX:"auto"},children:[e.jsx(oe,{component:X,children:e.jsxs(se,{sx:{minWidth:650},"aria-label":"simple table",children:[e.jsx(ne,{children:e.jsxs(G,{children:[e.jsx(l,{children:"Icon"}),e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Description"}),e.jsx(l,{children:"ID"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(te,{children:u.map(o=>e.jsxs(G,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(l,{children:N(o.icon)}),e.jsx(l,{children:o.name||"N/A"}),e.jsx(l,{children:o.description||"N/A"}),e.jsx(l,{component:"th",scope:"row",children:o.id}),e.jsx(l,{children:e.jsx(M,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:d=>v(d,o),children:e.jsx(K,{})})})]},o.id))})]})}),e.jsxs(Y,{id:"long-menu",anchorEl:m,open:!!m,onClose:s,children:[e.jsx(w,{onClick:c,children:"Edit"}),e.jsx(w,{onClick:A,children:"Delete"})]}),e.jsx(re,{open:C,onClose:o=>{if(o){const d=u.find(g=>g.id===o.id);a(d?u.map(g=>g.id===o.id?o:g):[o,...u])}j(!1)},toolGroup:r})]})})};export{ue as default};
